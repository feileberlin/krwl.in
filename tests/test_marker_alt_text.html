<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marker Alt Text Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .test-section h2 {
            margin-top: 0;
            color: #D689B8;
        }
        .before, .after {
            padding: 15px;
            margin: 10px 0;
            border-radius: 3px;
        }
        .before {
            background: #ffebee;
            border-left: 4px solid #c62828;
        }
        .after {
            background: #e8f5e9;
            border-left: 4px solid #2e7d32;
        }
        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .pass {
            color: #2e7d32;
        }
        .fail {
            color: #c62828;
        }
    </style>
</head>
<body>
    <h1>✅ Marker Alt Text Improvements Test</h1>
    <p>This page demonstrates the improvements to Leaflet marker alt text for accessibility and debugging.</p>

    <div class="test-section">
        <h2>Test 1: Event Markers</h2>
        <div class="before">
            <div class="label">❌ Before (Generic alt text):</div>
            <code>alt="music event marker"</code> or <code>alt=" event marker"</code> (when category is empty)
            <br><br>
            <strong class="fail">Issues:</strong>
            <ul>
                <li>Not descriptive enough for debugging</li>
                <li>Poor accessibility - doesn't identify which event</li>
                <li>Empty category creates meaningless alt text</li>
            </ul>
        </div>
        <div class="after">
            <div class="label">✅ After (Descriptive alt text):</div>
            <code>alt="Jazz Concert at Town Hall - music marker"</code>
            <br>
            <code>alt="Pub Quiz Night - pub-games marker"</code>
            <br>
            <code>alt="Summer Festival - festivals marker"</code>
            <br><br>
            <strong class="pass">Benefits:</strong>
            <ul>
                <li>✅ Includes event title (truncated to 30 chars if needed)</li>
                <li>✅ Falls back to "Event" if title is missing</li>
                <li>✅ Falls back to "default" if category is missing</li>
                <li>✅ Screen readers announce meaningful descriptions</li>
                <li>✅ Developers can identify events in DevTools</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>Test 2: GPS/Custom Location Markers</h2>
        <div class="before">
            <div class="label">❌ Before (No alt text):</div>
            <code>L.icon(...)</code> - Leaflet's L.icon doesn't support alt text in the API
            <br><br>
            <strong class="fail">Issues:</strong>
            <ul>
                <li>No alt text available for location markers</li>
                <li>Poor accessibility for screen readers</li>
                <li>Can't distinguish location marker from event markers</li>
            </ul>
        </div>
        <div class="after">
            <div class="label">✅ After (Descriptive alt text):</div>
            <code>alt="You are here"</code> (GPS location)
            <br>
            <code>alt="Reference location"</code> (default reference)
            <br>
            <code>alt="Custom location name"</code> (custom location)
            <br><br>
            <strong class="pass">Benefits:</strong>
            <ul>
                <li>✅ Switched from L.icon to L.divIcon to support HTML/alt text</li>
                <li>✅ Uses popup text as alt text for context</li>
                <li>✅ Falls back to "Location marker" if no popup text</li>
                <li>✅ Matches pattern used for event markers</li>
                <li>✅ Screen readers can distinguish location from event markers</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>Test 3: Edge Cases</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f5f5f5;">
                    <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Scenario</th>
                    <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Result</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Very long event title (>30 chars)</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><code>alt="Annual Summer Music Festival - music marker"</code> (truncated to 30 chars)</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Missing event title</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><code>alt="Event - music marker"</code> (fallback)</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Missing category</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><code>alt="Jazz Concert - default marker"</code> (fallback)</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Special characters in title</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><code>alt="Jazz & Blues @ Town Hall - music marker"</code> (preserved)</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">Location marker without popup</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><code>alt="Location marker"</code> (fallback)</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>Implementation Details</h2>
        <h3>Event Markers (assets/js/map.js, ~line 260):</h3>
        <pre style="background: #f5f5f5; padding: 15px; overflow-x: auto; border-radius: 3px;"><code>// Create descriptive alt text for accessibility and debugging
const eventTitle = event.title ? event.title.substring(0, 30) : 'Event';
const altText = `${eventTitle} - ${category} marker`;

const markerIcon = L.divIcon({
    className: 'custom-marker-icon',
    html: `&lt;img src="${iconUrl}" alt="${altText}" style="..." /&gt;`,
    ...
});</code></pre>

        <h3>Location Markers (assets/js/map.js, ~line 217):</h3>
        <pre style="background: #f5f5f5; padding: 15px; overflow-x: auto; border-radius: 3px;"><code>// Create descriptive alt text for accessibility
const locationAltText = popupText || 'Location marker';

// Use divIcon to allow HTML content with alt text
const userIcon = L.divIcon({
    className: 'custom-location-marker-icon',
    html: `&lt;img src="${userIconUrl}" alt="${locationAltText}" style="..." /&gt;`,
    ...
});</code></pre>
    </div>

    <div class="test-section">
        <h2>Testing Checklist</h2>
        <ul>
            <li>✅ Event markers show descriptive alt text with title and category</li>
            <li>✅ Long titles are truncated to 30 characters</li>
            <li>✅ Missing titles fall back to "Event"</li>
            <li>✅ Missing categories fall back to "default"</li>
            <li>✅ Location markers show descriptive alt text</li>
            <li>✅ GPS location shows "You are here"</li>
            <li>✅ Custom locations show their popup text as alt text</li>
            <li>✅ No breaking changes to existing functionality</li>
        </ul>
    </div>

    <script>
        console.log('✅ Marker Alt Text Test Page Loaded');
        console.log('To verify in the actual app:');
        console.log('1. Open the app in browser');
        console.log('2. Right-click on a marker → Inspect');
        console.log('3. Check the img element alt attribute');
        console.log('4. Use screen reader to test accessibility');
    </script>
</body>
</html>
