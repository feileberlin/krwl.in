{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "KRWL HOF Feature Registry - Documents all implemented features and how to test them",
  "version": "1.0.0",
  "features": [
    {
      "id": "event-scraping",
      "name": "Event Scraping",
      "description": "Scrape events from RSS feeds, APIs, and HTML pages",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/scraper.py"
      ],
      "config_keys": [
        "scraping.sources",
        "scraping.interval_minutes"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "editor-workflow",
      "name": "Editor Workflow",
      "description": "Review, edit, approve, or reject events before publishing",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/editor.py"
      ],
      "config_keys": [
        "editor.require_approval",
        "editor.auto_publish"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "python-tui",
      "name": "Python TUI (Text User Interface)",
      "description": "Interactive terminal interface for managing events with menu navigation",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "class EventManagerTUI|def show_menu|input.*Enter your choice",
          "description": "TUI class and menu system"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "cli-commands",
      "name": "CLI Commands",
      "description": "Command-line interface for automation and scripting",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "argparse|ArgumentParser|def cli_",
          "description": "CLI argument parsing and command functions"
        },
        {
          "file": "src/event_manager.py",
          "pattern": "def print_help",
          "description": "CLI help documentation"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "interactive-map",
      "name": "Interactive Map",
      "description": "Fullscreen map interface with Leaflet.js showing events",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/html/map-main.html",
        "assets/js/app.js"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "L\\.map\\('map'",
          "description": "Leaflet map initialization"
        },
        {
          "file": "assets/html/map-main.html",
          "pattern": "id=\"map\"",
          "description": "Map container element"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "geolocation-filtering",
      "name": "Geolocation Filtering",
      "description": "Shows only events near the user's location",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js"
      ],
      "config_keys": [
        "filtering.max_distance_km"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "navigator.geolocation.getCurrentPosition",
          "description": "Geolocation API usage"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "calculateDistance",
          "description": "Distance calculation function"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "sunrise-filtering",
      "name": "Sunrise Filtering",
      "description": "Displays events only until the next sunrise",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js"
      ],
      "config_keys": [
        "filtering.show_until"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "getNextSunrise|sunrise",
          "description": "Sunrise calculation or filtering"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "extended-time-filters",
      "name": "Extended Time Filter Options",
      "description": "Additional time filter options including Sunday primetime (20:15) and full moon timing. Provides more flexible event filtering beyond basic time ranges.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "assets/json/i18n/content.json",
        "assets/json/i18n/content.de.json"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "getNextSundayPrimetime|getNextFullMoonMorning|sunday-primetime|full-moon",
          "description": "Sunday primetime and full moon calculation methods"
        },
        {
          "file": "assets/json/i18n/content.json",
          "pattern": "sunday-primetime|full-moon",
          "description": "Time filter translations"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "static-site-generation",
      "name": "Static Site Generation (CDN Inliner)",
      "description": "Generates single-file static HTML with all resources inlined from CDN or local fallback",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/site_generator.py"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "debug-mode",
      "name": "Debug Mode",
      "description": "Debug mode with console logging for troubleshooting. Automatically enabled in development environment.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "config.json",
        "src/modules/utils.py"
      ],
      "config_keys": [],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "this.log|\\[KRWL Debug\\]",
          "description": "Debug logging implementation"
        },
        {
          "file": "config.json",
          "pattern": "_comment_hardcoded.*debug",
          "description": "Debug mode auto-detected (documented in config)"
        },
        {
          "file": "src/modules/utils.py",
          "pattern": "config\\['debug'\\]|debug.*=.*True|debug.*=.*False",
          "description": "Debug flag set in utils.py based on environment"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "production-optimization",
      "name": "Production Optimization",
      "description": "Production-optimized config with caching. Automatically enabled in CI/production.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "config.json",
        "src/modules/utils.py"
      ],
      "config_keys": [],
      "code_patterns": [
        {
          "file": "config.json",
          "pattern": "_comment_hardcoded.*cache|_comment_hardcoded.*prefetch",
          "description": "Caching auto-detected (documented in config)"
        },
        {
          "file": "src/modules/utils.py",
          "pattern": "cache_enabled|prefetch_events",
          "description": "Performance flags set in utils.py based on environment"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "preview-deployment",
      "name": "Preview Deployment",
      "description": "Deploy testing/preview version with debug mode",
      "category": "deployment",
      "implemented": false,
      "files": [
        ".github/workflows/deploy-preview.yml"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "production-deployment",
      "name": "Production Deployment",
      "description": "Deploy production version to main branch",
      "category": "deployment",
      "implemented": false,
      "files": [
        ".github/workflows/deploy-pages.yml"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "promotion-workflow",
      "name": "Promotion Workflow",
      "description": "Promote preview to production via PR",
      "category": "deployment",
      "implemented": false,
      "files": [
        ".github/workflows/promote-preview.yml"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "demo-events",
      "name": "Demo Events Generation",
      "description": "Generate demo events with current timestamps for testing",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/tools/generate_demo_events.py"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "multi-data-sources",
      "name": "Multiple Data Sources",
      "description": "Support for real, demo, or combined event data sources",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "config.json",
        "src/modules/utils.py"
      ],
      "config_keys": [
        "data.sources"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "loadEvents.*source|data.source",
          "description": "Data source selection logic"
        },
        {
          "file": "config.json",
          "pattern": "_comment_hardcoded.*data.source",
          "description": "Data source auto-detected (documented in config)"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "custom-domain-support",
      "name": "Custom Domain Support",
      "description": "Support for custom domains via CNAME",
      "category": "deployment",
      "implemented": false,
      "files": [
        "CNAME",
        ".github/workflows/deploy-pages.yml"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "event-filters",
      "name": "Event Filters",
      "description": "Filter events by category, time, and distance",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "assets/html/filter-nav.html"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "filterEvents|applyFilters",
          "description": "Event filtering logic"
        },
        {
          "file": "assets/html/filter-nav.html",
          "pattern": "event-filter-bar|filter-bar-time-range|filter-bar-distance|filter-bar-location",
          "description": "Filter UI elements"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "backup-system",
      "name": "Data Backup System",
      "description": "Automatic backups when clearing data with .backup extension",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "\\.backup|shutil.copy.*backup",
          "description": "Backup file creation"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "custom-location",
      "name": "Custom Location Override with localStorage Persistence",
      "description": "Allow users to set custom location instead of using geolocation. Custom coordinates persist in browser localStorage across sessions and location type switches.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "assets/html/filter-nav.html",
        "docs/custom-location-persistence.md"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "useCustomLocation|custom-location|customLat|customLon|saveFiltersToCookie|loadFiltersFromCookie",
          "description": "Custom location functionality with localStorage persistence"
        },
        {
          "file": "assets/html/filter-nav.html",
          "pattern": "filter-bar-location",
          "description": "Custom location UI elements"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "documentation-viewer",
      "name": "Built-in Documentation Viewer",
      "description": "CLI-based documentation viewer with task runner",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py",
        "src/modules/docs_runner.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "command == 'docs'|DocsRunner",
          "description": "Documentation CLI command"
        },
        {
          "file": "src/modules/docs_runner.py",
          "pattern": "class DocsRunner|list_tasks|run_task",
          "description": "Documentation runner implementation"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "example-data-loader",
      "name": "Example Data Loader",
      "description": "Load example/sample data for development and testing",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "def load_example_data|cli_load_examples|events_example",
          "description": "Example data loading functionality"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "data-management",
      "name": "Data Management Tools",
      "description": "CLI and TUI tools to clear, list, and manage event data",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/event_manager.py"
      ],
      "code_patterns": [
        {
          "file": "src/event_manager.py",
          "pattern": "def clear_all_data|cli_clear_data|cli_list",
          "description": "Data management commands"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "event-cards",
      "name": "Event Card UI",
      "description": "Card-based UI for displaying event details in the sidebar",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "assets/css/style.css",
        "public/index.html"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "event-card|renderEvents|event-list",
          "description": "Event card rendering"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "map-markers",
      "name": "Map Markers",
      "description": "Interactive markers on the map for events and user location",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "L\\.marker|this\\.markers|addEventMarkers",
          "description": "Leaflet marker management"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "distance-calculation",
      "name": "Distance Calculation",
      "description": "Haversine formula distance calculation between coordinates",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/utils.py",
        "assets/js/app.js"
      ],
      "code_patterns": [
        {
          "file": "src/modules/utils.py",
          "pattern": "def calculate_distance|Haversine",
          "description": "Distance calculation in Python"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "calculateDistance",
          "description": "Distance calculation in JavaScript"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "responsive-design",
      "name": "Responsive Design",
      "description": "Mobile-responsive layout with CSS media queries",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/css/style.css",
        "public/index.html"
      ],
      "code_patterns": [
        {
          "file": "assets/css/style.css",
          "pattern": "@media.*max-width|viewport",
          "description": "Responsive CSS media queries"
        },
        {
          "file": "public/index.html",
          "pattern": "viewport.*width=device-width",
          "description": "Viewport meta tag"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "workflow-launcher",
      "name": "GitHub Actions Workflow Launcher",
      "description": "Launch and manage GitHub Actions workflows using GitHub CLI (module exists but not integrated in TUI/CLI yet)",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/workflow_launcher.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/workflow_launcher.py",
          "pattern": "class WorkflowLauncher|def trigger_workflow|gh workflow run",
          "description": "Workflow launcher class and GitHub CLI integration"
        }
      ],
      "test_method": "check_code_patterns"
    },
    {
      "id": "copilot-custom-instructions",
      "name": "GitHub Copilot Custom Instructions",
      "description": "Comprehensive project-specific instructions for GitHub Copilot including architecture, coding guidelines, and workflows",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        ".github/copilot-instructions.md",
        ".github/COPILOT_SETUP.md",
        ".github/COPILOT_QUICK_REF.md",
        ".github/HOW_TO_CONFIGURE_COPILOT.md",
        ".github/CODEOWNERS",
        ".github/pull_request_template.md"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "vscode-workspace-config",
      "name": "VS Code Workspace Configuration",
      "description": "Workspace settings, recommended extensions, tasks, and debug configurations for VS Code",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        ".vscode/settings.json",
        ".vscode/extensions.json",
        ".vscode/tasks.json",
        ".vscode/launch.json"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "devcontainer-config",
      "name": "Development Container Configuration",
      "description": "Docker-based development container with Python 3.11, pre-configured tools, and automatic dependency installation",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        ".devcontainer/devcontainer.json"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "mcp-server-config",
      "name": "Model Context Protocol (MCP) Server Configuration",
      "description": "MCP server configuration for GitHub, filesystem, and memory context to enhance AI assistance",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        ".github/mcp/servers.json",
        ".github/mcp/README.md"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "dev-environment-docs",
      "name": "Development Environment Documentation",
      "description": "Comprehensive documentation for development environment setup including VS Code, devcontainer, and MCP configuration",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        "README.md"
      ],
      "test_method": "check_files_exist"
    },
    {
      "id": "dashboard-menu",
      "name": "Dashboard Menu with Project Information",
      "description": "Clickable logo opens dashboard menu showing About, Debug Info, Maintainer, Documentation links, and Credits. Replaces watermark functionality with better UX. Mobile-first responsive design with keyboard accessibility.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/html/dashboard-aside.html",
        "assets/css/style.css",
        "assets/js/app.js",
        "config.json",
        "src/modules/utils.py"
      ],
      "config_keys": [
        "app.environment"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "updateDashboard|dashboard-menu|dashboardLogo",
          "description": "Dashboard update function and menu toggle logic"
        },
        {
          "file": "assets/css/style.css",
          "pattern": "#dashboard-menu|.dashboard-content",
          "description": "Dashboard CSS styles"
        },
        {
          "file": "assets/html/dashboard-aside.html",
          "pattern": "dashboard-menu|dashboard-content|close-dashboard",
          "description": "Dashboard HTML structure"
        },
        {
          "file": "config.json",
          "pattern": "_comment_hardcoded.*watermark|_comment_hardcoded.*debug|_comment_hardcoded.*data.source",
          "description": "Environment-dependent values documented in config"
        }
      ],
      "test_method": "automated",
      "test_file": "tests/test_watermark_simplification.py",
      "test_instructions": "Run: python3 tests/test_watermark_simplification.py"
    },
    {
      "id": "environment-watermark",
      "name": "Environment Watermark (REPLACED by dashboard-menu)",
      "description": "DEPRECATED: This feature has been replaced by the dashboard menu. The watermark has been removed from the UI. Environment and debug information is now shown in the dashboard menu accessible by clicking the logo.",
      "category": "frontend",
      "implemented": false,
      "deprecated": true,
      "replaced_by": "dashboard-menu",
      "files": [],
      "config_keys": [
        "watermark.text"
      ],
      "code_patterns": [],
      "test_method": "none",
      "test_instructions": "This feature has been replaced by dashboard-menu. See dashboard-menu for testing."
    },
    {
      "id": "github-environments",
      "name": "GitHub Environments UI Integration",
      "description": "Configure GitHub Actions workflows to use environments, making deployments visible in GitHub UI with direct links to preview and production sites",
      "category": "infrastructure",
      "implemented": false,
      "files": [
        ".github/workflows/deploy-pages.yml",
        ".github/workflows/deploy-preview.yml"
      ],
      "config_keys": [],
      "code_patterns": [
        {
          "file": ".github/workflows/deploy-pages.yml",
          "pattern": "environment:\\s+name: production",
          "description": "Production environment configuration"
        },
        {
          "file": ".github/workflows/deploy-preview.yml",
          "pattern": "environment:\\s+name: preview",
          "description": "Preview environment configuration"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Navigate to GitHub repository\n2. Click 'Environments' in sidebar\n3. Verify 'production' and 'preview' environments are listed\n4. Click on environment to see deployment history\n5. Click 'View deployment' button to open deployed site"
    },
    {
      "id": "time-drawer",
      "name": "Dynamic Time-Based Marker Resizing",
      "description": "Interactive timeline drawer with dynamic marker scaling based on event proximity to selected time. Shows events from 'Now' to 'Sunrise' with smooth animations",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/time-drawer.js",
        "assets/css/time-drawer.css",
        "assets/js/app.js",
        "src/modules/site_generator.py"
      ],
      "code_patterns": [
        {
          "file": "assets/js/time-drawer.js",
          "pattern": "class TimeDrawer|calculateMarkerScale|applyMarkerScale",
          "description": "TimeDrawer class with marker scaling logic"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "this.timeDrawer|new TimeDrawer|registerMarker",
          "description": "TimeDrawer integration in EventsApp"
        },
        {
          "file": "assets/css/time-drawer.css",
          "pattern": ".time-drawer|.time-drawer-handle|.time-drawer-progress",
          "description": "Time drawer styling"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Open the app with 5+ events\n2. Set filter to 'til sunrise'\n3. Verify time drawer appears at bottom\n4. Drag the handle left/right\n5. Verify markers scale dynamically (70%-130%)\n6. Verify largest markers have glow effect\n7. Try with < 5 events - drawer should show threshold message\n8. Change filter to '6h' - drawer should disappear\n9. Test on mobile - touch gestures should work"
    },
    {
      "id": "keyboard-navigation",
      "name": "Keyboard Navigation",
      "description": "Full keyboard controls for map navigation and event browsing - ESC to close popups, arrow keys to navigate events, +/- to zoom",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "currentEventIndex|navigateEvents|keydown.*Escape|keydown.*Arrow",
          "description": "Keyboard event handling and navigation logic"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Open the app and click on an event to view details\n2. Press ESC - detail popup should close\n3. Open an event detail again\n4. Press Right Arrow - should navigate to next event (sorted by time)\n5. Press Left Arrow - should navigate to previous event\n6. Navigate past the last event - should wrap to first event\n7. Press + or = key - map should zoom in\n8. Press - or _ key - map should zoom out\n9. Test that map centers on events during arrow navigation\n10. Open filter dropdown and press ESC - dropdown should close"
    },
    {
      "id": "app-ready-signal",
      "name": "App Ready Signal for Screenshots",
      "description": "Emits a ready signal when the app is fully initialized (config loaded, map initialized, events loaded). Enables reliable screenshot generation by providing a data-app-ready attribute and custom event",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/app.js",
        "src/tools/generate_screenshots.py",
        "README.md"
      ],
      "code_patterns": [
        {
          "file": "assets/js/app.js",
          "pattern": "markAppAsReady|data-app-ready|app-ready.*CustomEvent",
          "description": "App ready signal implementation and emission"
        }
      ],
      "test_method": "automated",
      "test_instructions": "1. Start local server: cd static && python3 -m http.server 8000\n2. Run test script: python3 src/tools/generate_screenshots.py --verbose\n3. Verify body[data-app-ready='true'] attribute is set after page load\n4. Verify 'app-ready' custom event is dispatched with event.detail metadata\n5. Check that screenshots are captured with fully loaded map and events\n6. Verify both mobile (640×1136) and desktop (1280×800) screenshots are generated"
    },
    {
      "id": "html-export-linting",
      "name": "HTML Export Linting",
      "description": "Comprehensive linting of exported HTML, including JavaScript, CSS, HTML structure, SVG content, translations, and accessibility (a11y) checks during site generation",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/linter.py",
        "src/modules/site_generator.py",
        "tests/test_linter.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/linter.py",
          "pattern": "class Linter|lint_javascript|lint_css|lint_html|lint_svg|lint_translations|lint_accessibility",
          "description": "Linter implementation with multiple validation methods"
        },
        {
          "file": "src/modules/site_generator.py",
          "pattern": "from.*linter import Linter|linter.lint_all",
          "description": "Integration of linter into site generation process"
        }
      ],
      "test_method": "automated",
      "test_instructions": "1. Run unit tests: python3 tests/test_linter.py --verbose\n2. Generate site: python3 src/event_manager.py generate\n3. Verify linting output shows validation of:\n   - JavaScript (checks for eval(), console.log, bracket matching)\n   - CSS (checks for bracket matching, !important overuse)\n   - HTML (checks for doctype, lang attribute, required tags)\n   - SVG (checks for script tags, event handlers, security issues)\n   - Translations (checks for completeness, consistency between languages)\n   - Accessibility (checks for WCAG 2.1 Level AA compliance)\n4. Confirm build completes even with lint warnings (non-blocking)\n5. Review lint report for actionable issues"
    },
    {
      "id": "markdown-html-builder",
      "name": "Markdown to HTML Documentation Builder",
      "description": "Automated build system that converts all Markdown documentation to styled HTML with GitHub-style dark theme and Barbie Pink accents. Part of htmldocs_generator module.",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        "src/modules/htmldocs_generator.py",
        "src/tools/cleanup_old_docs.py",
        "scripts/README.md",
        "requirements.txt"
      ],
      "code_patterns": [
        {
          "file": "src/modules/htmldocs_generator.py",
          "pattern": "def convert_markdown_to_html|def generate_docs_index|def organize_files|markdown.Markdown",
          "description": "Core conversion and organization functions"
        },
        {
          "file": "src/modules/htmldocs_generator.py",
          "pattern": "Barbie Pink|color-primary|bg-primary|text-primary",
          "description": "Uses design tokens from config.json for theming"
        }
      ],
      "config_keys": [],
      "test_method": "manual",
      "test_instructions": "1. Install dependencies: pip install markdown>=3.5.0 Pygments>=2.17.0\n2. Build documentation: python3 src/event_manager.py docs build\n3. Verify all .md files converted to .html with:\n   - GitHub dark theme (#0d1117 background, #c9d1d9 text)\n   - Barbie Pink (#FF69B4) headings and accents\n   - Syntax highlighting in code blocks\n   - Navigation bar on every page\n4. Verify file organization in docs/\n5. Verify docs/index.html generated with categorized navigation\n6. Test cleanup script: python3 src/tools/cleanup_old_docs.py --dry-run\n7. Open docs/index.html in browser and verify it works with file:// protocol"
    },
    {
      "id": "pydantic-validation",
      "name": "Pydantic Data Validation",
      "description": "Type-safe data validation using Pydantic models for events, locations, and configuration. Ensures data integrity throughout the pipeline with automatic validation and helpful error messages.",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/models.py",
        "src/modules/scraper.py",
        "src/modules/editor.py",
        "src/modules/utils.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/models.py",
          "pattern": "class Event\\(BaseModel\\)|class Location\\(BaseModel\\)|@field_validator|validate_event_data",
          "description": "Pydantic models with field validators"
        }
      ],
      "test_method": "automated",
      "test_instructions": "Run: python3 tests/test_validation.py --verbose"
    },
    {
      "id": "error-handling-retry-logic",
      "name": "Robust Error Handling and Retry Logic",
      "description": "Graceful error handling with custom exceptions, exponential backoff retry logic for network requests, and source-level failure isolation. One failing source doesn't crash the entire scraping process.",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/exceptions.py",
        "src/modules/scraper.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/exceptions.py",
          "pattern": "class ScraperError|class NetworkError|class SourceUnavailableError|class ParsingError",
          "description": "Custom exception hierarchy"
        },
        {
          "file": "src/modules/scraper.py",
          "pattern": "@retry|make_retry_decorator|stop_after_attempt|wait_exponential",
          "description": "Retry logic with exponential backoff using tenacity"
        }
      ],
      "test_method": "integration",
      "test_instructions": "1. Run scraper with one invalid source: python3 src/event_manager.py scrape\n2. Verify scraper continues despite source failure\n3. Check logs for retry attempts and error details\n4. Verify _write_scrape_status includes error summary"
    },
    {
      "id": "structured-logging",
      "name": "Structured Logging System",
      "description": "Centralized logging configuration with appropriate log levels (DEBUG, INFO, WARNING, ERROR, CRITICAL), structured context data, and separate configurations for CLI and TUI modes. Includes rotating file handlers for production debugging.",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        "src/modules/logging_config.py",
        "src/event_manager.py",
        "src/modules/scraper.py",
        "src/modules/editor.py",
        "src/modules/utils.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/logging_config.py",
          "pattern": "def setup_logging|configure_for_cli|configure_for_tui|RotatingFileHandler",
          "description": "Logging configuration functions"
        },
        {
          "file": "src/modules/scraper.py",
          "pattern": "logger = logging.getLogger|logger.info|logger.error|logger.warning|extra=",
          "description": "Structured logging with context"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Run CLI with debug: python3 src/event_manager.py scrape --debug\n2. Verify DEBUG level logs appear\n3. Run TUI: python3 src/event_manager.py\n4. Verify logs written to logs/event_manager.log\n5. Check log rotation works (max 5MB per file)"
    },
    {
      "id": "configuration-validation",
      "name": "Configuration Validation",
      "description": "Validates config.json structure and values on load, including URLs, coordinates, and required fields. Provides helpful error messages with specific field names and expected values.",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/utils.py"
      ],
      "code_patterns": [
        {
          "file": "src/modules/utils.py",
          "pattern": "def validate_config|ConfigurationError|validate_config\\(config\\)",
          "description": "Configuration validation function"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Temporarily break config.json (invalid lat/lon, missing field)\n2. Run: python3 src/event_manager.py list\n3. Verify helpful ConfigurationError with field name\n4. Restore config.json"
    },
    {
      "id": "styled-html-docs",
      "name": "Styled HTML Documentation",
      "description": "HTML documentation viewer with Barbie Pink theme and emoji icons, auto-generated from Markdown",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        "src/modules/htmldocs_generator.py",
        "src/modules/docs_runner.py",
        "public/docs/"
      ],
      "config_keys": [
        "design.colors",
        "design.typography",
        "design.spacing"
      ],
      "test_method": "check_files_exist",
      "cli_command": "python3 src/event_manager.py docs html-docs"
    },
    {
      "id": "unified-workflow-wrapper",
      "name": "Unified Workflow Wrapper (Adaptive)",
      "description": "Single GitHub Actions workflow that automatically adapts to changes in event_scraper.py by introspecting scraper capabilities, configuration, and enabled sources at runtime. Combines scraping, building, deployment, and editorial review into one intelligent workflow.",
      "category": "infrastructure",
      "implemented": true,
      "files": [
        ".github/workflows/website-maintenance.yml",
        "src/modules/scraper.py",
        "src/event_manager.py"
      ],
      "config_keys": [
        "scraping.sources",
        "scraping.schedule.timezone",
        "scraping.schedule.times"
      ],
      "code_patterns": [
        {
          "file": "src/modules/scraper.py",
          "pattern": "get_scraper_capabilities|get_enabled_sources|get_scraping_schedule",
          "description": "Scraper introspection methods for workflow adaptation"
        },
        {
          "file": ".github/workflows/website-maintenance.yml",
          "pattern": "discover-capabilities|scraper-info|CAPABILITIES|review-pending",
          "description": "Workflow jobs for introspection and editorial review"
        },
        {
          "file": "src/event_manager.py",
          "pattern": "scraper-info|bulk-publish|bulk-reject",
          "description": "CLI commands for workflow integration"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Test scraper introspection: python3 src/event_manager.py scraper-info\n2. Validate workflow syntax: python3 -c \"import yaml; yaml.safe_load(open('.github/workflows/website-maintenance.yml'))\"\n3. Test editorial commands: python3 src/event_manager.py list-pending\n4. Trigger workflow manually via GitHub Actions UI with different task options (review-pending, info, scrape-and-deploy)\n5. Test auto-publish pattern: Set auto_publish_pattern to 'pending_*' and verify bulk publishing\n6. Verify workflow adapts when scraping sources are added/modified in config.json",
      "cli_command": "python3 src/event_manager.py scraper-info"
    },
    {
      "id": "event-archiving",
      "name": "Configurable Monthly Event Archiving",
      "description": "Automatically archive old events based on configurable retention window (default: 60 days). Events are organized by month into archive files (e.g., 202601.json) to keep the active events list manageable and improve performance. Configuration is entirely in config.json with GitHub Actions integration via unified website-maintenance workflow.",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/archive_events.py",
        "src/event_manager.py",
        ".github/workflows/website-maintenance.yml",
        "tests/test_archive_events.py"
      ],
      "config_keys": [
        "archiving.enabled",
        "archiving.schedule.day_of_month",
        "archiving.schedule.time",
        "archiving.schedule.timezone",
        "archiving.retention.active_window_days",
        "archiving.organization.format",
        "archiving.organization.path"
      ],
      "code_patterns": [
        {
          "file": "src/modules/archive_events.py",
          "pattern": "class EventArchiver|def archive_events|def _get_archive_filename",
          "description": "Archiver class with configurable retention and organization"
        },
        {
          "file": "src/event_manager.py",
          "pattern": "cli_archive_monthly|cli_archive_info|archive-monthly|archive-info",
          "description": "CLI commands for archiving and configuration display"
        },
        {
          "file": ".github/workflows/website-maintenance.yml",
          "pattern": "archive-monthly|retention_days",
          "description": "Monthly archiving job in unified workflow"
        }
      ],
      "test_method": "automated",
      "test_file": "tests/test_archive_events.py",
      "test_instructions": "1. Run archiving tests: python3 tests/test_archive_events.py\n2. Test dry-run: python3 src/event_manager.py archive-monthly --dry-run\n3. View configuration: python3 src/event_manager.py archive-info\n4. Test with different retention: Edit config.json → archiving.retention.active_window_days\n5. Verify archives created: Check assets/json/events/archived/ directory\n6. Test GitHub Actions: Trigger website-maintenance workflow with archive mode",
      "cli_command": "python3 src/event_manager.py archive-monthly --dry-run"
    },
    {
      "id": "responsive-viewport-system",
      "name": "Responsive Viewport System for Multi-Layer Architecture",
      "description": "CSS custom properties (--app-width, --app-height) with progressive enhancement that ensures all fixed-position layers scale consistently with the base map layer. Handles mobile browser address bars, orientation changes, and keyboard appearance. Includes JavaScript enhancement for pixel-perfect dimensions.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/css/base.css",
        "assets/css/map.css",
        "assets/css/filters.css",
        "assets/css/style.css",
        "assets/css/scrollbar.css",
        "assets/css/time-drawer.css",
        "assets/js/app.js",
        "docs/LAYER_ARCHITECTURE_ANALYSIS.md"
      ],
      "config_keys": [],
      "code_patterns": [
        {
          "file": "assets/css/base.css",
          "pattern": "--app-width|--app-height|100dvh|100dvw",
          "description": "CSS custom properties for viewport dimensions with progressive enhancement"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "updateViewportDimensions|setProperty\\('--app-width'|setProperty\\('--app-height'",
          "description": "JavaScript viewport dimension updater"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "addEventListener\\('resize'|addEventListener\\('orientationchange'",
          "description": "Event listeners for viewport changes"
        },
        {
          "file": "assets/css/map.css",
          "pattern": "width: var\\(--app-width\\)|height: var\\(--app-height\\)",
          "description": "Map layer uses CSS custom properties"
        }
      ],
      "test_method": "manual",
      "test_instructions": "1. Open app in browser\n2. Verify no hardcoded 100vh/100vw in layers: grep -r '100vh\\|100vw' assets/css/*.css\n3. Test mobile: Open DevTools → Mobile view → Toggle device toolbar\n4. Test orientation: Rotate device/emulator from portrait to landscape\n5. Test address bar: Scroll on mobile to hide/show address bar\n6. Verify CSS variables: Open DevTools → Elements → :root → Check --app-width and --app-height\n7. Test resize: Resize browser window and verify all layers scale together\n8. Test keyboard: On mobile, focus input field to show keyboard, verify layers adjust\n9. Architecture analysis: Read docs/LAYER_ARCHITECTURE_ANALYSIS.md for design rationale"
    },
    {
      "id": "url-based-i18n",
      "name": "URL-Based Internationalization (i18n)",
      "description": "URL-based language routing with German as default (/) and English at (/en/). No language menu - purely URL-driven language selection.",
      "category": "frontend",
      "implemented": true,
      "files": [
        "assets/js/i18n.js",
        "assets/json/i18n/content.json",
        "assets/json/i18n/content.de.json",
        "src/modules/site_generator.py"
      ],
      "code_patterns": [
        {
          "file": "assets/js/i18n.js",
          "pattern": "detectLanguageFromURL|getContentBasePath",
          "description": "URL path language detection and relative path handling"
        },
        {
          "file": "src/modules/site_generator.py",
          "pattern": "public/en/index.html|lang=",
          "description": "Multi-language HTML generation"
        }
      ],
      "test_method": "check_code_patterns",
      "test_instructions": "1. Run translation tests: python3 tests/test_translations.py --verbose\n2. Generate site: python3 src/event_manager.py generate\n3. Verify two HTML files created:\n   - public/index.html (German, lang=\"de\")\n   - public/en/index.html (English, lang=\"en\")\n4. Check translation files copied to both directories\n5. Test URL detection:\n   - Open / → should default to German\n   - Open /en/ → should use English\n6. Verify no language menu in UI"
    },
    {
      "id": "weather-dresscode",
      "name": "Weather Dresscode Display",
      "description": "Scrape current weather conditions from MSN Weather and display dresscode recommendations in filter bar with format 'with [dresscode].' (e.g., 'with warm pullover.'). Weather data is inlined in HTML as window.WEATHER_CACHE. Validates dresscodes against accepted list. Hourly caching prevents excessive requests. Can be triggered manually via GitHub Actions workflow.",
      "category": "backend",
      "implemented": true,
      "files": [
        "src/modules/weather_scraper.py",
        "src/modules/site_generator.py",
        "assets/json/weather_dresscodes.json",
        "assets/html/filter-nav.html",
        "assets/js/app.js",
        "assets/css/style.css",
        ".github/workflows/website-maintenance.yml"
      ],
      "config_keys": [
        "weather.enabled",
        "weather.cache_hours",
        "weather.locations",
        "weather.display.show_in_filter_bar"
      ],
      "code_patterns": [
        {
          "file": "src/modules/weather_scraper.py",
          "pattern": "class WeatherScraper|_extract_dresscode|_validate_dresscode",
          "description": "Weather scraper with dresscode extraction and validation"
        },
        {
          "file": "assets/js/app.js",
          "pattern": "loadWeather|displayWeatherDresscode|window.WEATHER_CACHE",
          "description": "Frontend weather loading from inlined cache"
        },
        {
          "file": "assets/html/filter-nav.html",
          "pattern": "filter-bar-weather|weather-chip",
          "description": "Weather chip in filter bar"
        },
        {
          "file": "src/modules/site_generator.py",
          "pattern": "load_weather_cache|window.WEATHER_CACHE",
          "description": "Weather cache inlined in HTML"
        },
        {
          "file": ".github/workflows/website-maintenance.yml",
          "pattern": "scrape-weather|Scrape Weather",
          "description": "GitHub Actions workflow for weather scraping"
        }
      ],
      "test_method": "check_code_patterns",
      "test_instructions": "1. Run weather scraper: python3 src/event_manager.py scrape-weather\n2. Verify cache created: assets/json/weather_cache.json\n3. Check dresscode is validated against accepted list\n4. Generate site: python3 src/event_manager.py generate\n5. Verify window.WEATHER_CACHE is embedded in public/index.html\n6. Open site and verify weather chip appears at end of filter bar\n7. Verify dresscode text is displayed in format 'with [dresscode].' (e.g., 'with warm pullover.')\n8. Hover over chip to see temperature tooltip (e.g., '8°C • with warm pullover.')\n9. Test hourly caching: run scrape-weather again within 1 hour, should use cache\n10. Force refresh: python3 src/event_manager.py scrape-weather --force\n11. Test GitHub Actions: Go to Actions → Website Maintenance (Unified) → Run workflow → Select 'scrape-weather'"
    }
  ]
}